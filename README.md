# @smallfish2025/scan

[![npm version](https://badge.fury.io/js/%40smallfish2025%2Fscan.svg)](https://badge.fury.io/js/%40smallfish2025%2Fscan)
[![License: ISC](https://img.shields.io/badge/License-ISC-blue.svg)](https://opensource.org/licenses/ISC)

ä¸€ä¸ªçµæ´»ä¸”åŠŸèƒ½ä¸°å¯Œçš„ Node.js æ–‡ä»¶æ‰«æå™¨ï¼Œå…è®¸é€šè¿‡è‡ªå®šä¹‰è§„åˆ™ç²¾ç¡®åœ°æŸ¥æ‰¾æ–‡ä»¶ã€‚

## ç‰¹æ€§

- **åŸºäºè§„åˆ™çš„åŒ¹é…**: å®šä¹‰åŒ…å«æ–‡ä»¶åç¼€åˆ—è¡¨å’Œæ–‡ä»¶åæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™ï¼Œç²¾ç¡®åŒ¹é…æ‰€éœ€æ–‡ä»¶ã€‚
- **æ·±åº¦æ§åˆ¶**: é™åˆ¶æ‰«æçš„ç›®å½•æ·±åº¦ï¼Œæˆ–æ‰«ææ‰€æœ‰å­ç›®å½•ã€‚
- **ç›®å½•æ’é™¤**: é€šè¿‡ `skipDirs` é€‰é¡¹è½»æ¾è·³è¿‡æŒ‡å®šç›®å½•ï¼ˆå¦‚ `node_modules`, `.git`ï¼‰ã€‚
- **æ–‡ä»¶å¤§å°é™åˆ¶**: é€šè¿‡ `maxFileSize` é€‰é¡¹å¿½ç•¥è¿‡å¤§çš„æ–‡ä»¶ã€‚
- **å®æ—¶è¿›åº¦æŠ¥å‘Š**: é€šè¿‡ `onProgress` å›è°ƒå‡½æ•°è·å–è¯¦ç»†çš„æ‰«æè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰ç›®å½•ã€æ‰«æç»Ÿè®¡ä»¥åŠ**å®æ—¶åŒ¹é…åˆ°çš„æ–‡ä»¶ä¿¡æ¯**ã€‚
- **å‹ç¼©åŒ…æ‰«æ**: **è‡ªåŠ¨æ‰«æå¹¶åŒ¹é… ZIP, TAR, TGZ, RAR å‹ç¼©åŒ…å†…çš„æ–‡ä»¶**ï¼Œè¡Œä¸ºä¸æ‰«ææ™®é€šæ–‡ä»¶ç³»ç»Ÿä¸€è‡´ã€‚
- **TypeScript æ”¯æŒ**: ä½¿ç”¨ TypeScript ç¼–å†™ï¼Œæä¾›å®Œæ•´çš„ç±»å‹å®šä¹‰ã€‚

## å®‰è£…

```bash
npm install @smallfish2025/scan
# æˆ–è€…
yarn add @smallfish2025/scan
```

## ä½¿ç”¨æ–¹æ³•

```typescript
// å¯¼å…¥å¿…è¦çš„æ¨¡å—å’Œç±»å‹
import { scanFiles, FileItem, MatchRule, ScanProgress, ScanResult, FailureItem } from '@smallfish2025/scan';
import * as path from 'path';

// å®šä¹‰ä¸€ä¸ªå¼‚æ­¥å‡½æ•°æ¥æ‰§è¡Œæ‰«ææ“ä½œ
async function scanMyFiles() {
  // å®šä¹‰æ–‡ä»¶åŒ¹é…è§„åˆ™åˆ—è¡¨
  // æ¯ä¸ªè§„åˆ™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼š
  // 1. ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œè¡¨ç¤ºè¦åŒ¹é…çš„æ–‡ä»¶åç¼€åï¼ˆä¸éœ€è¦å¸¦ç‚¹ï¼Œå¤§å°å†™ä¸æ•æ„Ÿï¼‰
  // 2. ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºåŒ¹é…æ–‡ä»¶åçš„æ­£åˆ™è¡¨è¾¾å¼
  const rules: MatchRule[] = [
    // è§„åˆ™1: åŒ¹é…æ‰€æœ‰ä»¥ 'MeiTuan' å¼€å¤´çš„ .docx æˆ– .doc æ–‡ä»¶
    [['docx', 'doc'], '^MeiTuan.*'],
    // è§„åˆ™2: åŒ¹é…æ‰€æœ‰ä»¥ 'BuYunSou' å¼€å¤´çš„ .pdf æˆ– .xls æ–‡ä»¶
    [['pdf', 'xls'], '^BuYunSou.*'],
    // è§„åˆ™3: åŒ¹é…æ‰€æœ‰ .jpg æ–‡ä»¶
    [['jpg'], '.*']
  ];

  // å®šä¹‰è¦æ‰«æçš„æ ¹ç›®å½• (è¯·æ›¿æ¢ä¸ºä½ çš„å®é™…è·¯å¾„)
  // æ³¨æ„ï¼šä¸ºäº†è¿è¡Œæ­¤ç¤ºä¾‹ï¼Œä½ éœ€è¦ç¡®ä¿è¿™ä¸ªç›®å½•ä¸‹æœ‰ç¬¦åˆè§„åˆ™çš„æ–‡ä»¶æˆ–å‹ç¼©åŒ…
  const targetRootDir = '/path/to/your/scan/directory';

  // å®šä¹‰è¦è·³è¿‡çš„ç›®å½•åˆ—è¡¨ï¼ˆç›¸å¯¹äºæ ¹ç›®å½•ï¼‰
  // æ‰«æå™¨ä¼šå¿½ç•¥è¿™äº›ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ï¼Œä¹Ÿä¸ä¼šæ‰«æè¿™äº›ç›®å½•ä¸‹çš„å‹ç¼©åŒ…
  const skipDirs = ['node_modules', '.git', 'temp', 'dist'];

  // å®šä¹‰å•ä¸ªæ–‡ä»¶çš„æœ€å¤§å¤§å°é™åˆ¶ï¼ˆå­—èŠ‚ï¼‰
  // è¶…è¿‡æ­¤å¤§å°çš„æ–‡ä»¶ï¼ˆæ— è®ºæ˜¯æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶è¿˜æ˜¯å‹ç¼©åŒ…å†…æ–‡ä»¶è§£å‹åçš„å¤§å°ï¼‰å°†è¢«å¿½ç•¥
  const maxSize = 500 * 1024 * 1024; // 500 MB

  // å®šä¹‰æ‰«æé€‰é¡¹å¯¹è±¡
  const scanOptions = {
    // å¿…éœ€ï¼šæ‰«æçš„æ ¹ç›®å½•
    rootDir: targetRootDir,
    // å¿…éœ€ï¼šæ–‡ä»¶åŒ¹é…è§„åˆ™
    matchRules: rules,
    // æ‰«ææ·±åº¦ï¼š-1 è¡¨ç¤ºæ‰«ææ‰€æœ‰å­ç›®å½•ï¼ˆé»˜è®¤å€¼ï¼‰
    // 0 è¡¨ç¤ºåªæ‰«ææ ¹ç›®å½•ï¼Œ1 è¡¨ç¤ºæ‰«æåˆ°ç¬¬ä¸€å±‚å­ç›®å½•ï¼Œä»¥æ­¤ç±»æ¨
    depth: -1,
    // å¯é€‰ï¼šæœ€å¤§æ–‡ä»¶å¤§å°é™åˆ¶
    maxFileSize: maxSize,
    // å¯é€‰ï¼šè¦è·³è¿‡çš„ç›®å½•åˆ—è¡¨
    skipDirs: skipDirs,
    // å¯é€‰ï¼šè¿›åº¦å›è°ƒå‡½æ•°
    // æ¯æ‰«æä¸€ä¸ªç›®å½•ã€æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…æ–‡ä»¶æˆ–é‡åˆ°è·³è¿‡æƒ…å†µæ—¶ï¼Œå¯èƒ½ä¼šè°ƒç”¨æ­¤å‡½æ•°
    onProgress: (progress: ScanProgress, matchedFile?: FileItem) => {
      // è¿›åº¦ä¿¡æ¯ (progress å¯¹è±¡)
      // console.log(`å½“å‰æ‰«æç›®å½•: ${progress.currentDir}`);
      // console.log(`å·²æ‰«æç›®å½•æ•°: ${progress.scannedDirs}`);
      // console.log(`å·²æ‰«ææ–‡ä»¶æ•°: ${progress.scannedFiles}`);
      // console.log(`å·²æ‰«æå‹ç¼©åŒ…æ•°: ${progress.archivesScanned}`);
      // console.log(`å·²æ‰¾åˆ°åŒ¹é…æ–‡ä»¶æ•°: ${progress.matchedFiles}`);
      // console.log(`å› è¿‡å¤§å¿½ç•¥çš„æ–‡ä»¶æ•°: ${progress.ignoredLargeFiles}`);
      // console.log(`è·³è¿‡çš„ç›®å½•æ•°: ${progress.skippedDirs}`);

      // å¦‚æœå½“å‰å›è°ƒæ˜¯ç”±äºæ‰¾åˆ°äº†åŒ¹é…æ–‡ä»¶è€Œè§¦å‘çš„ï¼ŒmatchedFile ä¼šæœ‰å€¼
      if (matchedFile) {
        // æ‰“å°æ‰¾åˆ°çš„åŒ¹é…æ–‡ä»¶çš„ä¿¡æ¯
        console.log(`[å®æ—¶æ‰¾åˆ°]: ${matchedFile.name}`);
        // å¯ä»¥æ ¹æ® matchedFile.origin åˆ¤æ–­æ¥æº
        if (matchedFile.origin === 'archive') {
          // å¦‚æœæ¥è‡ªå‹ç¼©åŒ…ï¼Œå¯ä»¥è®¿é—® archivePath å’Œ internalPath
          console.log(`  -> æ¥æº: å‹ç¼©åŒ… (${matchedFile.archivePath})`);
          console.log(`  -> å†…éƒ¨è·¯å¾„: ${matchedFile.internalPath}`);
        } else {
          // å¦‚æœæ¥è‡ªæ–‡ä»¶ç³»ç»Ÿï¼Œorigin å¯èƒ½æ˜¯ 'filesystem' æˆ– undefined
          console.log(`  -> æ¥æº: æ–‡ä»¶ç³»ç»Ÿ (${matchedFile.path})`);
        }
      }
    }
  };

  // ä½¿ç”¨ try...catch åŒ…è£¹ä»¥å¤„ç†å¯èƒ½çš„é¡¶å±‚é”™è¯¯ï¼ˆå°½ç®¡å¤§éƒ¨åˆ†é”™è¯¯ä¼šè¢«æ”¶é›†åˆ° failures ä¸­ï¼‰
  try {
    // è®°å½•å¼€å§‹æ‰«æçš„ä¿¡æ¯
    console.log(`\nğŸš€ å¼€å§‹æ‰«æç›®å½•: ${scanOptions.rootDir}`);
    console.log(`   è§„åˆ™æ•°: ${scanOptions.matchRules.length}`);
    console.log(`   è·³è¿‡ç›®å½•: ${scanOptions.skipDirs.join(', ') || 'æ— '}`);

    // è°ƒç”¨ scanFiles å‡½æ•°æ‰§è¡Œæ‰«æï¼Œå®ƒè¿”å›ä¸€ä¸ªåŒ…å« results å’Œ failures çš„ Promise
    // ä½¿ç”¨ await ç­‰å¾…æ‰«æå®Œæˆ
    const { results, failures }: ScanResult = await scanFiles(scanOptions);

    // ---- å¤„ç†æ‰«æç»“æœ ----

    // æ‰“å°æ‰«æå®Œæˆçš„æç¤ºä¿¡æ¯
    console.log('\nâœ… æ‰«æå®Œæˆ!');
    console.log('=================');

    // æ‰“å°æˆåŠŸåŒ¹é…çš„æ–‡ä»¶åˆ—è¡¨
    console.log(`ğŸ“Š æ‰¾åˆ° ${results.length} ä¸ªåŒ¹é…æ–‡ä»¶:`);
    console.log('-----------------');
    // éå† results æ•°ç»„
    results.forEach((file: FileItem, index: number) => {
      // æ‰“å°æ¯ä¸ªæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯
      console.log(`[${index + 1}] ${file.name}`);
      // æ ¹æ®æ¥æºæ˜¾ç¤ºä¸åŒçš„è·¯å¾„ä¿¡æ¯
      if (file.origin === 'archive') {
        console.log(`    æ¥æº: å‹ç¼©åŒ…`);
        console.log(`    å‹ç¼©åŒ…è·¯å¾„: ${file.archivePath}`);
        console.log(`    å†…éƒ¨æ–‡ä»¶è·¯å¾„: ${file.internalPath}`);
      } else {
        console.log(`    æ¥æº: æ–‡ä»¶ç³»ç»Ÿ`);
        console.log(`    æ–‡ä»¶è·¯å¾„: ${file.path}`);
      }
      // æ‰“å°æ–‡ä»¶å¤§å°ï¼ˆè½¬æ¢ä¸º KBï¼‰
      console.log(`    å¤§å°: ${(file.size / 1024).toFixed(2)} KB`);
      // æ‰“å°åˆ›å»ºå’Œä¿®æ”¹æ—¶é—´ï¼ˆæœ¬åœ°åŒ–æ ¼å¼ï¼‰
      console.log(`    åˆ›å»ºæ—¶é—´: ${file.createTime.toLocaleString()}`);
      console.log(`    ä¿®æ”¹æ—¶é—´: ${file.modifyTime.toLocaleString()}`);
      console.log('-----------------');
    });

    // æ£€æŸ¥æ˜¯å¦æœ‰æ‰«æå¤±è´¥çš„æƒ…å†µ
    if (failures.length > 0) {
      // å¦‚æœ failures æ•°ç»„ä¸ä¸ºç©ºï¼Œåˆ™æ‰“å°é”™è¯¯æç¤º
      console.warn('\nâš ï¸ æ‰«æè¿‡ç¨‹ä¸­é‡åˆ°ä»¥ä¸‹é”™è¯¯:');
      console.warn('=================');
      // éå† failures æ•°ç»„
      failures.forEach((fail: FailureItem, index: number) => {
        // æ‰“å°æ¯ä¸ªå¤±è´¥é¡¹çš„è¯¦ç»†ä¿¡æ¯
        console.warn(`[é”™è¯¯ ${index + 1}] ç±»å‹: ${fail.type}`);
        console.warn(`  è·¯å¾„: ${fail.path}`);
        // å¦‚æœæ˜¯å‹ç¼©åŒ…å†…éƒ¨æ¡ç›®é”™è¯¯ï¼Œæ‰“å°å†…éƒ¨è·¯å¾„
        if (fail.entryPath) {
          console.warn(`  å†…éƒ¨æ¡ç›®: ${fail.entryPath}`);
        }
        // æ‰“å°å…·ä½“çš„é”™è¯¯æ¶ˆæ¯
        console.warn(`  é”™è¯¯è¯¦æƒ…: ${fail.error}`);
        console.warn('-----------------');
      });
    } else {
      // å¦‚æœ failures æ•°ç»„ä¸ºç©ºï¼Œåˆ™æ‰“å°æ— é”™è¯¯æç¤º
      console.log('\nğŸ‘ æ‰«æè¿‡ç¨‹ä¸­æœªæŠ¥å‘Šä»»ä½•é”™è¯¯ã€‚');
    }

  } catch (error: any) {
    // æ•è·å¹¶æ‰“å°åœ¨è°ƒç”¨ scanFiles è¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿçš„ã€æœªè¢«å†…éƒ¨æ•è·çš„æ„å¤–é”™è¯¯
    console.error('\nâŒ æ‰«æè¿‡ç¨‹ä¸­å‘ç”Ÿä¸¥é‡é”™è¯¯:', error.message || error);
  }
}

// è°ƒç”¨æ‰§è¡Œæ‰«æçš„å‡½æ•°
scanMyFiles();
```

## API

### `scanFiles(options: ScanOptions): Promise<ScanResult>`

å¼‚æ­¥æ‰«ææŒ‡å®šç›®å½•å¹¶è¿”å›ä¸€ä¸ªåŒ…å«æˆåŠŸåŒ¹é…æ–‡ä»¶åˆ—è¡¨å’Œå¤±è´¥ä¿¡æ¯åˆ—è¡¨çš„å¯¹è±¡ã€‚

#### `ScanOptions`

| é€‰é¡¹          | ç±»å‹                                                   | æè¿°                                                              | é»˜è®¤å€¼             |
|---------------|------------------------------------------------------|-----------------------------------------------------------------|-----------------|
| `rootDir`     | `string`                                             | **å¿…éœ€**ï¼Œè¦æ‰«æçš„æ ¹ç›®å½•ç»å¯¹è·¯å¾„ã€‚                                     |                 |
| `matchRules`  | `MatchRule[]` (å³ `[string[], string][]`)              | **å¿…éœ€**ï¼Œæ–‡ä»¶åŒ¹é…è§„åˆ™åˆ—è¡¨ã€‚æ¯ä¸ªè§„åˆ™æ˜¯ä¸€ä¸ªå…ƒç»„ `[åç¼€åˆ—è¡¨, æ–‡ä»¶åæ­£åˆ™]`ã€‚ |                 |
| `depth`       | `number`                                             | æ‰«ææ·±åº¦ã€‚`0` è¡¨ç¤ºåªæ‰«ææ ¹ç›®å½•ï¼Œ`-1` è¡¨ç¤ºæ‰«ææ‰€æœ‰å­ç›®å½•ã€‚               | `-1`            |
| `maxFileSize` | `number`                                             | æ–‡ä»¶å¤§å°ä¸Šé™ï¼ˆå­—èŠ‚ï¼‰ã€‚è¶…è¿‡æ­¤å¤§å°çš„æ–‡ä»¶å°†è¢«å¿½ç•¥ï¼ˆå¯¹å‹ç¼©åŒ…å†…æ–‡ä»¶åŒæ ·æœ‰æ•ˆï¼‰ã€‚       | `524288000` (500MB) |
| `skipDirs`    | `string[]`                                           | è¦è·³è¿‡çš„ç›®å½•ååˆ—è¡¨ï¼ˆç›¸å¯¹äº `rootDir` çš„è·¯å¾„ï¼Œå¦‚ `['node_modules']`ï¼‰ã€‚æ‰«æå™¨ä¸ä¼šè¿›å…¥è¿™äº›ç›®å½•ï¼Œä¹Ÿä¸ä¼šæ‰«æè¿™äº›ç›®å½•ä¸‹çš„å‹ç¼©åŒ…ã€‚ | `[]`            |
| `onProgress`  | `(progress: ScanProgress, matchedFile?: FileItem) => void` | å¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œç”¨äºæŠ¥å‘Šæ‰«æè¿›åº¦å’Œå®æ—¶åŒ¹é…åˆ°çš„æ–‡ä»¶ã€‚                      |                 |

#### `FileItem`

| å±æ€§         | ç±»å‹     | æè¿°                                                              |
|--------------|----------|-----------------------------------------------------------------|
| `path`       | `string` | æ–‡ä»¶æˆ–å…¶æ‰€åœ¨å‹ç¼©åŒ…çš„ç»å¯¹è·¯å¾„ã€‚                                         |
| `name`       | `string` | æ–‡ä»¶å (å¯¹äºå‹ç¼©åŒ…å†…æ–‡ä»¶ï¼Œæ˜¯å…¶åœ¨å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶å)ã€‚                            |
| `createTime` | `Date`   | æ–‡ä»¶æˆ–å…¶æ‰€åœ¨å‹ç¼©åŒ…çš„åˆ›å»ºæ—¶é—´ã€‚                                      |
| `modifyTime` | `Date`   | æ–‡ä»¶æˆ–å…¶æ‰€åœ¨å‹ç¼©åŒ…çš„ä¿®æ”¹æ—¶é—´ã€‚                                      |
| `size`       | `number` | æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ (å¯¹äºå‹ç¼©åŒ…å†…æ–‡ä»¶ï¼Œæ˜¯å…¶è§£å‹åçš„å¤§å°)ã€‚                       |
| `origin`     | `'filesystem' \| 'archive'` | æ–‡ä»¶æ¥æºï¼š`'filesystem'` è¡¨ç¤ºæ¥è‡ªæ–‡ä»¶ç³»ç»Ÿï¼Œ`'archive'` è¡¨ç¤ºæ¥è‡ªå‹ç¼©åŒ…ã€‚          |
| `archivePath`| `string?` | å¦‚æœ `origin` æ˜¯ `'archive'`ï¼Œè¡¨ç¤ºè¯¥æ–‡ä»¶æ‰€åœ¨çš„å‹ç¼©åŒ…çš„ç»å¯¹è·¯å¾„ã€‚              |
| `internalPath`| `string?` | å¦‚æœ `origin` æ˜¯ `'archive'`ï¼Œè¡¨ç¤ºè¯¥æ–‡ä»¶åœ¨å‹ç¼©åŒ…å†…çš„ç›¸å¯¹è·¯å¾„ã€‚                 |

#### `ScanResult`

`scanFiles` å‡½æ•°è¿”å›çš„å¯¹è±¡ç±»å‹ã€‚

| å±æ€§        | ç±»å‹          | æè¿°               |
|-------------|---------------|------------------|
| `results`   | `FileItem[]`  | æˆåŠŸåŒ¹é…çš„æ–‡ä»¶åˆ—è¡¨   |
| `failures`  | `FailureItem[]` | æ‰«æè¿‡ç¨‹ä¸­å‘ç”Ÿçš„å¤±è´¥åˆ—è¡¨ |

#### `ScanProgress`

| å±æ€§                | ç±»å‹     | æè¿°               |
|---------------------|----------|------------------|
| `currentDir`        | `string` | å½“å‰æ­£åœ¨æ‰«æçš„ç›®å½•     |
| `scannedFiles`      | `number` | å·²æ‰«æçš„æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶æ€»æ•° |
| `scannedDirs`       | `number` | å·²æ‰«æçš„ç›®å½•æ€»æ•°     |
| `archivesScanned`   | `number` | å·²å°è¯•æ‰«æçš„å‹ç¼©åŒ…æ€»æ•° |
| `matchedFiles`      | `number` | æ‰¾åˆ°çš„åŒ¹é…æ–‡ä»¶æ€»æ•°   |
| `ignoredLargeFiles` | `number` | å› è¿‡å¤§è€Œè¢«å¿½ç•¥çš„æ–‡ä»¶æ•° |
| `skippedDirs`       | `number` | å› è§„åˆ™è€Œè¢«è·³è¿‡çš„ç›®å½•æ•° |

#### `FailureItem`

è¡¨ç¤ºæ‰«æè¿‡ç¨‹ä¸­å‘ç”Ÿçš„å•æ¬¡å¤±è´¥çš„ä¿¡æ¯ã€‚

| å±æ€§        | ç±»å‹                                                        | æè¿°                                                        |
|-------------|-------------------------------------------------------------|-----------------------------------------------------------|
| `type`      | `'directoryAccess' \| 'fileStat' \| 'archiveOpen' \| 'archiveEntry' \| 'rarOpen'` | å¤±è´¥ç±»å‹ã€‚                                                    |
| `path`      | `string`                                                    | å‘ç”Ÿå¤±è´¥çš„æ–‡ä»¶ã€ç›®å½•æˆ–å‹ç¼©åŒ…çš„ç»å¯¹è·¯å¾„ã€‚                                |
| `entryPath` | `string?`                                                   | å¯é€‰ï¼Œä»…å½“ `type` ä¸º `'archiveEntry'` æ—¶ï¼Œè¡¨ç¤ºå‹ç¼©åŒ…å†…éƒ¨å‘ç”Ÿé”™è¯¯çš„æ¡ç›®è·¯å¾„ã€‚ |
| `error`     | `string`                                                    | å…·ä½“çš„é”™è¯¯ä¿¡æ¯ï¼ˆé€šå¸¸æ¥è‡ªåº•å±‚é”™è¯¯å¯¹è±¡çš„ `message` å±æ€§ï¼‰ã€‚                 |

## æµ‹è¯•ä¸ç¤ºä¾‹ä¸­çš„ RAR æ–‡ä»¶

æœ¬åº“æ”¯æŒæ‰«æ RAR å‹ç¼©åŒ…ã€‚ç„¶è€Œï¼Œç”±äº Node.js ç”Ÿæ€ä¸­ç¼ºä¹ç›´æ¥åˆ›å»º RAR æ–‡ä»¶çš„æ ‡å‡†åº“ï¼ˆRAR æ ¼å¼æ˜¯ä¸“æœ‰çš„ï¼‰ï¼Œæœ¬åº“çš„è‡ªåŠ¨åŒ–æµ‹è¯• (`npm test`) å’Œç¤ºä¾‹ä»£ç  (`npm run example`) **æ— æ³•è‡ªåŠ¨ç”Ÿæˆç”¨äºæµ‹è¯•çš„ `.rar` æ–‡ä»¶**ã€‚

å¦‚æœæ‚¨éœ€è¦ï¼š

1. **è¿è¡ŒåŒ…å« RAR æ‰«æçš„å®Œæ•´æµ‹è¯•**: è¯·æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªåä¸º `test-archive.rar` çš„å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ç¬¦åˆ `src/__tests__/scanner.test.ts` ä¸­è§„åˆ™çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œ`rar-match.txt`, `docs/MeiTuan-rar.docx` ç­‰ï¼‰ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `test-files/archives/` ç›®å½•ä¸­ã€‚
2. **åœ¨ç¤ºä¾‹ä¸­æŸ¥çœ‹ RAR æ–‡ä»¶æ‰«æ**: è¯·æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªåŒ…å«æ–‡ä»¶çš„ `.rar` æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œ`my-test.rar`ï¼‰ï¼Œå°†å…¶æ”¾å…¥ `example-test-run/archives/` ç›®å½•ï¼ˆè¿è¡Œ `npm run example` å‰ï¼Œå¦‚æœè¯¥ç›®å½•ä¸å­˜åœ¨ï¼Œè„šæœ¬ä¼šåˆ›å»ºå®ƒï¼‰ï¼Œå¹¶ç¡®ä¿ `src/example.ts` ä¸­çš„ `matchRules` èƒ½å¤ŸåŒ¹é…æ‚¨æ”¾å…¥çš„ RAR æ–‡ä»¶å†…éƒ¨çš„æ–‡ä»¶ã€‚
3. **åœ¨ç¤ºä¾‹æŸ¥çœ‹å¤±è´¥è¿”å›**ï¼šæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªåŠ å¯†çš„zipæ–‡ä»¶æ”¾å…¥æµ‹è¯•æ–‡ä»¶å¤¹ï¼Œä¼šè¿”å›å¤±è´¥çš„æ¶ˆæ¯ã€‚

```bash
æ‰«æè¿‡ç¨‹ä¸­é‡åˆ°ä»¥ä¸‹é”™è¯¯:
-----------------
[å¤±è´¥ 1] ç±»å‹: archiveOpen
  è·¯å¾„: /Users/daiwangjian/wkspace/js-projects/scan/example-test-run/readme.md.zip
  é”™è¯¯: entry is encrypted, and options.decrypt !== false
```

å¦‚æœæµ‹è¯•æˆ–ç¤ºä¾‹è¿è¡Œæ—¶æœªæ‰¾åˆ°å¯¹åº”çš„ `.rar` æ–‡ä»¶ï¼Œç›¸å…³æµ‹è¯•æ–­è¨€ä¼šè¢«è·³è¿‡ï¼Œæˆ–è€…ç¤ºä¾‹ä¸­ä¸ä¼šæ˜¾ç¤ºæ¥è‡ª RAR çš„æ–‡ä»¶ï¼Œä½†ä¸ä¼šå¯¼è‡´è„šæœ¬å¤±è´¥ã€‚

## è®¸å¯è¯

[ISC](https://opensource.org/licenses/ISC)

## ä»“åº“

[https://github.com/waitfish/scan.git](https://github.com/waitfish/scan.git) 